{
  "version": "1.0.0",
  "type": "retool_app",
  "metadata": {
    "name": "AutoBid Admin Panel",
    "description": "ĞŸĞ¾Ğ»Ğ½Ğ°Ñ Ğ°Ğ´Ğ¼Ğ¸Ğ½-Ğ¿Ğ°Ğ½ĞµĞ»ÑŒ Ğ´Ğ»Ñ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ğ°Ğ²Ñ‚Ğ¾Ğ°ÑƒĞºÑ†Ğ¸Ğ¾Ğ½Ğ¾Ğ¼",
    "apiBaseUrl": "https://task-tracker-serviceapp225.replit.app"
  },
  "resourceQueries": [
    {
      "name": "getStats",
      "resourceType": "restapi",
      "url": "https://task-tracker-serviceapp225.replit.app/api/admin/stats",
      "method": "GET",
      "headers": {
        "x-admin-key": "retool-admin-key-2024"
      },
      "runWhenPageLoads": true
    },
    {
      "name": "getUsers",
      "resourceType": "restapi", 
      "url": "https://task-tracker-serviceapp225.replit.app/api/admin/users",
      "method": "GET",
      "headers": {
        "x-admin-key": "retool-admin-key-2024"
      },
      "runWhenPageLoads": true,
      "transformer": "return data.map(user => ({...user, statusDisplay: user.isActive ? 'ĞĞºÑ‚Ğ¸Ğ²ĞµĞ½' : 'ĞĞµĞ°ĞºÑ‚Ğ¸Ğ²ĞµĞ½', statusColor: user.isActive ? 'green' : 'red', createdDisplay: new Date(user.createdAt).toLocaleDateString('ru-RU'), phoneDisplay: user.phoneNumber || 'ĞĞµ ÑƒĞºĞ°Ğ·Ğ°Ğ½'}));"
    },
    {
      "name": "getListings",
      "resourceType": "restapi",
      "url": "https://task-tracker-serviceapp225.replit.app/api/admin/listings", 
      "method": "GET",
      "headers": {
        "x-admin-key": "retool-admin-key-2024"
      },
      "runWhenPageLoads": true,
      "transformer": "return data.map(listing => ({...listing, currentBidDisplay: `${listing.currentBid || listing.startingPrice} ÑĞ¾Ğ¼Ğ¾Ğ½Ğ¸`, sellerDisplay: listing.seller?.fullName || 'ĞĞµĞ¸Ğ·Ğ²ĞµÑÑ‚Ğ½Ğ¾', carDisplay: `${listing.make} ${listing.model} ${listing.year}`, statusColor: {'pending': 'orange', 'active': 'green', 'ended': 'gray', 'rejected': 'red'}[listing.status] || 'gray'}));"
    },
    {
      "name": "getBids",
      "resourceType": "restapi",
      "url": "https://task-tracker-serviceapp225.replit.app/api/admin/bids",
      "method": "GET", 
      "headers": {
        "x-admin-key": "retool-admin-key-2024"
      },
      "runWhenPageLoads": true,
      "transformer": "return data.map(bid => ({...bid, amountDisplay: `${bid.amount} ÑĞ¾Ğ¼Ğ¾Ğ½Ğ¸`, bidderDisplay: bid.bidder?.fullName || 'ĞĞµĞ¸Ğ·Ğ²ĞµÑÑ‚Ğ½Ğ¾', carDisplay: `${bid.listing?.make} ${bid.listing?.model} ${bid.listing?.year}`, lotDisplay: bid.listing?.lotNumber, dateDisplay: new Date(bid.createdAt).toLocaleDateString('ru-RU'), timeDisplay: new Date(bid.createdAt).toLocaleTimeString('ru-RU'), bidderPhone: bid.bidder?.phoneNumber || 'ĞĞµ ÑƒĞºĞ°Ğ·Ğ°Ğ½'}));"
    },
    {
      "name": "activateUser",
      "resourceType": "restapi",
      "url": "https://task-tracker-serviceapp225.replit.app/api/admin/users/{{usersTable.selectedRow.id}}/status",
      "method": "PATCH",
      "headers": {
        "x-admin-key": "retool-admin-key-2024",
        "Content-Type": "application/json"
      },
      "body": "{\"isActive\": true}",
      "successHandlers": ["getUsers.trigger()", "getStats.trigger()"]
    },
    {
      "name": "deactivateUser", 
      "resourceType": "restapi",
      "url": "https://task-tracker-serviceapp225.replit.app/api/admin/users/{{usersTable.selectedRow.id}}/status",
      "method": "PATCH",
      "headers": {
        "x-admin-key": "retool-admin-key-2024",
        "Content-Type": "application/json"
      },
      "body": "{\"isActive\": false}",
      "successHandlers": ["getUsers.trigger()", "getStats.trigger()"]
    },
    {
      "name": "approveListing",
      "resourceType": "restapi",
      "url": "https://task-tracker-serviceapp225.replit.app/api/listings/{{listingsTable.selectedRow.id}}/status",
      "method": "PATCH",
      "headers": {
        "x-admin-key": "retool-admin-key-2024",
        "Content-Type": "application/json"
      },
      "body": "{\"status\": \"active\"}",
      "successHandlers": ["getListings.trigger()", "getStats.trigger()"]
    },
    {
      "name": "rejectListing",
      "resourceType": "restapi", 
      "url": "https://task-tracker-serviceapp225.replit.app/api/listings/{{listingsTable.selectedRow.id}}/status",
      "method": "PATCH",
      "headers": {
        "x-admin-key": "retool-admin-key-2024",
        "Content-Type": "application/json"
      },
      "body": "{\"status\": \"rejected\"}",
      "successHandlers": ["getListings.trigger()", "getStats.trigger()"]
    }
  ],
  "pages": [
    {
      "name": "Dashboard",
      "components": [
        {
          "type": "text",
          "id": "statsTitle",
          "value": "ğŸ“Š Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° Ğ¿Ğ»Ğ°Ñ‚Ñ„Ğ¾Ñ€Ğ¼Ñ‹ AutoBid",
          "style": {"fontSize": "24px", "fontWeight": "bold", "marginBottom": "20px"}
        },
        {
          "type": "text",
          "id": "pendingStats",
          "value": "ğŸ• ĞĞ¶Ğ¸Ğ´Ğ°ÑÑ‰Ğ¸Ğµ Ğ¾Ğ±ÑŠÑĞ²Ğ»ĞµĞ½Ğ¸Ñ: {{getStats.data.pendingListings}}",
          "style": {"fontSize": "18px", "color": "orange", "padding": "10px", "border": "2px solid orange", "borderRadius": "8px", "marginBottom": "10px"}
        },
        {
          "type": "text", 
          "id": "activeStats",
          "value": "ğŸ”¥ ĞĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ğµ Ğ°ÑƒĞºÑ†Ğ¸Ğ¾Ğ½Ñ‹: {{getStats.data.activeAuctions}}",
          "style": {"fontSize": "18px", "color": "green", "padding": "10px", "border": "2px solid green", "borderRadius": "8px", "marginBottom": "10px"}
        },
        {
          "type": "text",
          "id": "usersStats", 
          "value": "ğŸ‘¥ Ğ’ÑĞµĞ³Ğ¾ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹: {{getStats.data.totalUsers}}",
          "style": {"fontSize": "18px", "color": "blue", "padding": "10px", "border": "2px solid blue", "borderRadius": "8px", "marginBottom": "10px"}
        },
        {
          "type": "text",
          "id": "bannedStats",
          "value": "ğŸš« Ğ—Ğ°Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğµ: {{getStats.data.bannedUsers}}",
          "style": {"fontSize": "18px", "color": "red", "padding": "10px", "border": "2px solid red", "borderRadius": "8px", "marginBottom": "10px"}
        },
        {
          "type": "button",
          "id": "refreshStatsBtn",
          "text": "ğŸ”„ ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºÑƒ",
          "color": "primary",
          "eventHandlers": [{"event": "click", "action": "getStats.trigger()"}]
        }
      ]
    },
    {
      "name": "ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ğ¸",
      "components": [
        {
          "type": "text",
          "id": "usersTitle",
          "value": "ğŸ‘¥ Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑĞ¼Ğ¸",
          "style": {"fontSize": "24px", "fontWeight": "bold", "marginBottom": "20px"}
        },
        {
          "type": "textinput",
          "id": "userSearch",
          "placeholder": "ğŸ” ĞŸĞ¾Ğ¸ÑĞº Ğ¿Ğ¾ Ğ¸Ğ¼ĞµĞ½Ğ¸ Ğ¸Ğ»Ğ¸ Ñ‚ĞµĞ»ĞµÑ„Ğ¾Ğ½Ñƒ",
          "width": "100%"
        },
        {
          "type": "table",
          "id": "usersTable",
          "dataSource": "{{getUsers.data.filter(user => !userSearch.value || user.fullName?.toLowerCase().includes(userSearch.value.toLowerCase()) || user.phoneNumber?.includes(userSearch.value))}}",
          "selection": "single",
          "columns": [
            {"key": "id", "title": "ID", "width": 60},
            {"key": "fullName", "title": "ğŸ‘¤ Ğ˜Ğ¼Ñ", "width": 150},
            {"key": "phoneDisplay", "title": "ğŸ“ Ğ¢ĞµĞ»ĞµÑ„Ğ¾Ğ½", "width": 120},
            {"key": "email", "title": "ğŸ“§ Email", "width": 200},
            {"key": "statusDisplay", "title": "ğŸ”˜ Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ", "width": 100},
            {"key": "role", "title": "ğŸ­ Ğ Ğ¾Ğ»ÑŒ", "width": 80},
            {"key": "createdDisplay", "title": "ğŸ“… Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½", "width": 100}
          ]
        },
        {
          "type": "button",
          "id": "activateBtn",
          "text": "âœ… ĞĞºÑ‚Ğ¸Ğ²Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ",
          "color": "success",
          "disabled": "{{!usersTable.selectedRow || usersTable.selectedRow.isActive}}",
          "eventHandlers": [{"event": "click", "action": "activateUser.trigger()"}]
        },
        {
          "type": "button",
          "id": "deactivateBtn", 
          "text": "âŒ Ğ”ĞµĞ°ĞºÑ‚Ğ¸Ğ²Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ",
          "color": "danger",
          "disabled": "{{!usersTable.selectedRow || !usersTable.selectedRow.isActive}}",
          "eventHandlers": [{"event": "click", "action": "deactivateUser.trigger()"}]
        },
        {
          "type": "button",
          "id": "refreshUsersBtn",
          "text": "ğŸ”„ ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ",
          "color": "primary",
          "eventHandlers": [{"event": "click", "action": "getUsers.trigger()"}]
        }
      ]
    },
    {
      "name": "ĞĞ±ÑŠÑĞ²Ğ»ĞµĞ½Ğ¸Ñ",
      "components": [
        {
          "type": "text",
          "id": "listingsTitle",
          "value": "ğŸš— ĞœĞ¾Ğ´ĞµÑ€Ğ°Ñ†Ğ¸Ñ Ğ¾Ğ±ÑŠÑĞ²Ğ»ĞµĞ½Ğ¸Ğ¹",
          "style": {"fontSize": "24px", "fontWeight": "bold", "marginBottom": "20px"}
        },
        {
          "type": "select",
          "id": "statusFilter",
          "options": [
            {"value": "all", "label": "ğŸ“‹ Ğ’ÑĞµ Ğ¾Ğ±ÑŠÑĞ²Ğ»ĞµĞ½Ğ¸Ñ"},
            {"value": "pending", "label": "ğŸ• ĞĞ¶Ğ¸Ğ´Ğ°ÑÑ‰Ğ¸Ğµ"},
            {"value": "active", "label": "âœ… ĞĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ğµ"},
            {"value": "ended", "label": "ğŸ Ğ—Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ½Ñ‹Ğµ"},
            {"value": "rejected", "label": "âŒ ĞÑ‚ĞºĞ»Ğ¾Ğ½ĞµĞ½Ğ½Ñ‹Ğµ"}
          ],
          "defaultValue": "all"
        },
        {
          "type": "table",
          "id": "listingsTable",
          "dataSource": "{{statusFilter.value === 'all' ? getListings.data : getListings.data.filter(item => item.status === statusFilter.value)}}",
          "selection": "single",
          "columns": [
            {"key": "id", "title": "ID", "width": 60},
            {"key": "lotNumber", "title": "ğŸ« Ğ›Ğ¾Ñ‚", "width": 80},
            {"key": "carDisplay", "title": "ğŸš— ĞĞ²Ñ‚Ğ¾Ğ¼Ğ¾Ğ±Ğ¸Ğ»ÑŒ", "width": 200},
            {"key": "currentBidDisplay", "title": "ğŸ’° Ğ¦ĞµĞ½Ğ°", "width": 120},
            {"key": "status", "title": "ğŸ“Š Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ", "width": 100},
            {"key": "sellerDisplay", "title": "ğŸ‘¤ ĞŸÑ€Ğ¾Ğ´Ğ°Ğ²ĞµÑ†", "width": 150},
            {"key": "bidCount", "title": "ğŸ”¥ Ğ¡Ñ‚Ğ°Ğ²Ğ¾Ğº", "width": 70}
          ]
        },
        {
          "type": "button",
          "id": "approveBtn",
          "text": "âœ… ĞĞ´Ğ¾Ğ±Ñ€Ğ¸Ñ‚ÑŒ",
          "color": "success",
          "disabled": "{{!listingsTable.selectedRow || listingsTable.selectedRow.status !== 'pending'}}",
          "eventHandlers": [{"event": "click", "action": "approveListing.trigger()"}]
        },
        {
          "type": "button",
          "id": "rejectBtn",
          "text": "âŒ ĞÑ‚ĞºĞ»Ğ¾Ğ½Ğ¸Ñ‚ÑŒ", 
          "color": "danger",
          "disabled": "{{!listingsTable.selectedRow || listingsTable.selectedRow.status !== 'pending'}}",
          "eventHandlers": [{"event": "click", "action": "rejectListing.trigger()"}]
        },
        {
          "type": "text",
          "id": "selectedListingInfo",
          "value": "{{listingsTable.selectedRow ? `ğŸ“‹ Ğ’Ñ‹Ğ±Ñ€Ğ°Ğ½Ğ¾: ${listingsTable.selectedRow.carDisplay} | ğŸ« Ğ›Ğ¾Ñ‚: ${listingsTable.selectedRow.lotNumber} | ğŸ‘¤ ĞŸÑ€Ğ¾Ğ´Ğ°Ğ²ĞµÑ†: ${listingsTable.selectedRow.sellerDisplay}` : 'ğŸ‘† Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ Ğ¾Ğ±ÑŠÑĞ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€Ğ° Ğ´ĞµÑ‚Ğ°Ğ»ĞµĞ¹'}}"
        }
      ]
    },
    {
      "name": "Ğ¡Ñ‚Ğ°Ğ²ĞºĞ¸",
      "components": [
        {
          "type": "text",
          "id": "bidsTitle",
          "value": "ğŸ’° ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ ÑÑ‚Ğ°Ğ²Ğ¾Ğº",
          "style": {"fontSize": "24px", "fontWeight": "bold", "marginBottom": "20px"}
        },
        {
          "type": "textinput",
          "id": "userFilter",
          "placeholder": "ğŸ” ĞŸĞ¾Ğ¸ÑĞº Ğ¿Ğ¾ Ğ¸Ğ¼ĞµĞ½Ğ¸ Ğ¿Ğ¾ĞºÑƒĞ¿Ğ°Ñ‚ĞµĞ»Ñ",
          "width": "48%"
        },
        {
          "type": "textinput",
          "id": "carFilter",
          "placeholder": "ğŸ” ĞŸĞ¾Ğ¸ÑĞº Ğ¿Ğ¾ Ğ¼Ğ°Ñ€ĞºĞµ/Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸",
          "width": "48%"
        },
        {
          "type": "text",
          "id": "bidsStats",
          "value": "ğŸ“Š Ğ’ÑĞµĞ³Ğ¾ ÑÑ‚Ğ°Ğ²Ğ¾Ğº: {{getBids.data.length}} | ğŸ’° ĞĞ±Ñ‰Ğ°Ñ ÑÑƒĞ¼Ğ¼Ğ°: {{getBids.data.reduce((sum, bid) => sum + parseFloat(bid.amount), 0).toLocaleString()}} ÑĞ¾Ğ¼Ğ¾Ğ½Ğ¸ | ğŸ‘¥ Ğ£Ğ½Ğ¸ĞºĞ°Ğ»ÑŒĞ½Ñ‹Ñ… Ğ¿Ğ¾ĞºÑƒĞ¿Ğ°Ñ‚ĞµĞ»ĞµĞ¹: {{new Set(getBids.data.map(bid => bid.bidderId)).size}}",
          "style": {"fontSize": "16px", "padding": "10px", "backgroundColor": "#f0f0f0", "borderRadius": "8px"}
        },
        {
          "type": "table",
          "id": "bidsTable",
          "dataSource": "{{getBids.data.filter(bid => (!userFilter.value || bid.bidderDisplay.toLowerCase().includes(userFilter.value.toLowerCase())) && (!carFilter.value || bid.carDisplay.toLowerCase().includes(carFilter.value.toLowerCase())))}}",
          "columns": [
            {"key": "id", "title": "ID", "width": 60},
            {"key": "amountDisplay", "title": "ğŸ’° Ğ¡ÑƒĞ¼Ğ¼Ğ°", "width": 120},
            {"key": "bidderDisplay", "title": "ğŸ‘¤ ĞŸĞ¾ĞºÑƒĞ¿Ğ°Ñ‚ĞµĞ»ÑŒ", "width": 150},
            {"key": "bidderPhone", "title": "ğŸ“ Ğ¢ĞµĞ»ĞµÑ„Ğ¾Ğ½", "width": 120},
            {"key": "carDisplay", "title": "ğŸš— ĞĞ²Ñ‚Ğ¾Ğ¼Ğ¾Ğ±Ğ¸Ğ»ÑŒ", "width": 200},
            {"key": "lotDisplay", "title": "ğŸ« Ğ›Ğ¾Ñ‚", "width": 80},
            {"key": "dateDisplay", "title": "ğŸ“… Ğ”Ğ°Ñ‚Ğ°", "width": 100},
            {"key": "timeDisplay", "title": "ğŸ• Ğ’Ñ€ĞµĞ¼Ñ", "width": 80}
          ]
        },
        {
          "type": "button",
          "id": "refreshBidsBtn",
          "text": "ğŸ”„ ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ ÑÑ‚Ğ°Ğ²ĞºĞ¸",
          "color": "primary",
          "eventHandlers": [{"event": "click", "action": "getBids.trigger()"}]
        }
      ]
    }
  ],
  "navigation": [
    {"label": "ğŸ“Š Dashboard", "page": "Dashboard"},
    {"label": "ğŸ‘¥ ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ğ¸", "page": "ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ğ¸"},
    {"label": "ğŸš— ĞĞ±ÑŠÑĞ²Ğ»ĞµĞ½Ğ¸Ñ", "page": "ĞĞ±ÑŠÑĞ²Ğ»ĞµĞ½Ğ¸Ñ"},
    {"label": "ğŸ’° Ğ¡Ñ‚Ğ°Ğ²ĞºĞ¸", "page": "Ğ¡Ñ‚Ğ°Ğ²ĞºĞ¸"}
  ]
}