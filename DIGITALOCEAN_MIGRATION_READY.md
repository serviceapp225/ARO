# üöÄ DigitalOcean App Platform - –ì–æ—Ç–æ–≤ –∫ –º–∏–≥—Ä–∞—Ü–∏–∏

## ‚úÖ –°—Ç–∞—Ç—É—Å –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏: –ó–ê–í–ï–†–®–ï–ù–û
–í—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–∞ DigitalOcean App Platform –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω—ã –∏ –≥–æ—Ç–æ–≤—ã –∫ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é.

---

## üì¶ –ü–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### 1. –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è
- **Dockerfile** - –º—É–ª—å—Ç–∏-—Å—Ç–∞–¥–∏–π–Ω—ã–π –æ–±—Ä–∞–∑ —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π
- **.dockerignore** - –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –ª–∏—à–Ω–∏—Ö —Ñ–∞–π–ª–æ–≤
- **–°–±–æ—Ä–∫–∞**: Node.js 20, –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π production –æ–±—Ä–∞–∑

### 2. App Platform –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- **.platform.app.yaml** - —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–ª—è App Platform
- **Health check** - endpoint `/health` –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- **–ü–æ—Ä—Ç**: 8080 (—Å—Ç–∞–Ω–¥–∞—Ä—Ç App Platform)

### 3. –•—Ä–∞–Ω–∏–ª–∏—â–µ —Ñ–∞–π–ª–æ–≤
- **server/spacesService.ts** - DigitalOcean Spaces –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- **server/migrateToSpaces.ts** - —Å–∫—Ä–∏–ø—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- **AWS SDK** - —É–∂–µ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ –ø—Ä–æ–µ–∫—Ç

### 4. Environment –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- **production.env.template** - —à–∞–±–ª–æ–Ω –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- –í—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã

### 5. Build —Å–∏—Å—Ç–µ–º–∞
- **package.json** - –≥–æ—Ç–æ–≤—ã–µ —Å–∫—Ä–∏–ø—Ç—ã —Å–±–æ—Ä–∫–∏
- Vite + esbuild –¥–ª—è production –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

---

## üéØ –ü–æ—à–∞–≥–æ–≤—ã–π –ø–ª–∞–Ω –º–∏–≥—Ä–∞—Ü–∏–∏ (6-8 —á–∞—Å–æ–≤)

### –®–∞–≥ 1: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ DigitalOcean Managed Database (30 –º–∏–Ω) ‚úÖ
```bash
# –£–∂–µ —Å–æ–∑–¥–∞–Ω–∞ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö PostgreSQL –≤ AMS3
# –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –≥–æ—Ç–æ–≤—ã
```

### –®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ Spaces –¥–ª—è —Ñ–∞–π–ª–æ–≤–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ (20 –º–∏–Ω)
1. –°–æ–∑–¥–∞—Ç—å Spaces bucket: `autobid-storage`
2. –†–µ–≥–∏–æ–Ω: `ams3` (Amsterdam)
3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å API –∫–ª—é—á–∏
4. –¢–µ—Å—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

### –®–∞–≥ 3: –°–æ–∑–¥–∞–Ω–∏–µ App Platform –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (45 –º–∏–Ω)
1. –ü–æ–¥–∫–ª—é—á–∏—Ç—å GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
2. –í—ã–±—Ä–∞—Ç—å —Ç–∏–ø: Web Service
3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å:
   - Build Command: `npm run build`
   - Start Command: `npm start`
   - Port: 8080
   - Health Check: `/health`

### –®–∞–≥ 4: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è (30 –º–∏–Ω)
–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∏–∑ `production.env.template` –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç—å:
- `DATABASE_URL` (–∏–∑ Managed Database)
- `SPACES_KEY`, `SPACES_SECRET` (–∏–∑ Spaces)
- `SESSION_SECRET` (–Ω–æ–≤—ã–π –¥–ª—è production)
- SMS –∏ –¥—Ä—É–≥–∏–µ API –∫–ª—é—á–∏

### –®–∞–≥ 5: –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö (2-3 —á–∞—Å–∞)
```bash
# –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ç–µ–∫—É—â–µ–π –ë–î
pg_dump $CURRENT_DB_URL > autobid_backup.sql

# –ò–º–ø–æ—Ä—Ç –≤ –Ω–æ–≤—É—é –ë–î
psql $NEW_DATABASE_URL < autobid_backup.sql

# –ú–∏–≥—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ Spaces
npm run migrate:spaces
```

### –®–∞–≥ 6: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∑–∞–ø—É—Å–∫ (2-3 —á–∞—Å–∞)
1. Deploy –≤ App Platform
2. –ü—Ä–æ–≤–µ—Ä–∫–∞ health endpoint
3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–æ–º–µ–Ω–∞

---

## üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
- **App Platform**: $35-40/–º–µ—Å—è—Ü (Web Service + Workers)
- **Managed PostgreSQL**: $15/–º–µ—Å—è—Ü
- **Spaces**: ~$5/–º–µ—Å—è—Ü (250GB —Ö—Ä–∞–Ω–∏–ª–∏—â–µ)
- **–ò—Ç–æ–≥–æ**: ~$55-60/–º–µ—Å—è—Ü

---

## üìã –ì–æ—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- ‚úÖ `Dockerfile` - –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è
- ‚úÖ `.dockerignore` - –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–±–æ—Ä–∫–∏
- ‚úÖ `.platform.app.yaml` - App Platform —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å DigitalOcean Spaces
- ‚úÖ `server/spacesService.ts` - —Å–µ—Ä–≤–∏—Å —Ä–∞–±–æ—Ç—ã —Å Spaces
- ‚úÖ `server/migrateToSpaces.ts` - —Å–∫—Ä–∏–ø—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ —Ñ–∞–π–ª–æ–≤

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- ‚úÖ `production.env.template` - —à–∞–±–ª–æ–Ω –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- ‚úÖ Health check endpoint –≤ `server/routes.ts`

### –°–±–æ—Ä–∫–∞ –∏ –¥–µ–ø–ª–æ–π
- ‚úÖ Build —Å–∫—Ä–∏–ø—Ç—ã –≤ `package.json`
- ‚úÖ Production –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### Health Check
```typescript
GET /health
{
  "status": "healthy",
  "database": { "connected": true },
  "fileStorage": { "uploadsDirectory": true },
  "environment": { "nodeEnv": "production", "port": 8080 }
}
```

### Spaces –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- –ü—É–±–ª–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ —Ñ–∞–π–ª–∞–º  
- –ú–∏–≥—Ä–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ñ–∞–π–ª–æ–≤
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è CDN

### Database
- SSL —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ
- Connection pooling –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- Automatic failover –≤ Managed Database

---

## üö® –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ

### –ü–µ—Ä–µ–¥ –º–∏–≥—Ä–∞—Ü–∏–µ–π
1. **–°–æ–∑–¥–∞—Ç—å backup** –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö
2. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å** –Ω–∞ staging –æ–∫—Ä—É–∂–µ–Ω–∏–∏
3. **–ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å rollback –ø–ª–∞–Ω**
4. **–£–≤–µ–¥–æ–º–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π** –æ –≤—Ä–µ–º–µ–Ω–Ω–æ–π –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- –í—Å–µ —Å–µ–∫—Ä–µ—Ç–Ω—ã–µ –∫–ª—é—á–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –Ω–æ–≤—ã–º–∏ –¥–ª—è production
- DATABASE_URL –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å `sslmode=require`
- SPACES_ENDPOINT –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è —Ä–µ–≥–∏–æ–Ω–∞

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- Health check endpoint —Ä–∞–±–æ—Ç–∞–µ—Ç
- –õ–æ–≥–∏ App Platform –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- Alerts –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫

---

## üéâ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –º–∏–≥—Ä–∞—Ü–∏–∏: 100%

–í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω—ã, –∫–æ–¥ –≥–æ—Ç–æ–≤ –∫ production –¥–µ–ø–ª–æ—é –Ω–∞ DigitalOcean App Platform. –ú–æ–∂–Ω–æ –ø—Ä–∏—Å—Ç—É–ø–∞—Ç—å –∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é –ø–æ—à–∞–≥–æ–≤–æ–≥–æ –ø–ª–∞–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏–∏.

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥**: –°–æ–∑–¥–∞–Ω–∏–µ DigitalOcean Spaces bucket –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Managed Database.