{
  "version": "3.0.0",
  "metadata": {
    "name": "AutoBid Admin Panel",
    "description": "–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞–≤—Ç–æ–∞—É–∫—Ü–∏–æ–Ω–æ–º"
  },
  "queries": {
    "getStats": {
      "id": "getStats",
      "type": "restapi",
      "data": {
        "url": "https://task-tracker-serviceapp225.replit.app/api/admin/stats",
        "method": "GET",
        "headers": {
          "x-admin-key": "retool-admin-key-2024"
        }
      },
      "settings": {
        "runWhenPageLoads": true
      }
    },
    "getUsers": {
      "id": "getUsers", 
      "type": "restapi",
      "data": {
        "url": "https://task-tracker-serviceapp225.replit.app/api/admin/users",
        "method": "GET",
        "headers": {
          "x-admin-key": "retool-admin-key-2024"
        }
      },
      "settings": {
        "runWhenPageLoads": true
      },
      "transformer": "return data.map(user => ({...user, statusDisplay: user.isActive ? '–ê–∫—Ç–∏–≤–µ–Ω' : '–ù–µ–∞–∫—Ç–∏–≤–µ–Ω', statusColor: user.isActive ? 'green' : 'red', createdDisplay: new Date(user.createdAt).toLocaleDateString('ru-RU'), phoneDisplay: user.phoneNumber || '–ù–µ —É–∫–∞–∑–∞–Ω'}));"
    },
    "getListings": {
      "id": "getListings",
      "type": "restapi", 
      "data": {
        "url": "https://task-tracker-serviceapp225.replit.app/api/admin/listings",
        "method": "GET",
        "headers": {
          "x-admin-key": "retool-admin-key-2024"
        }
      },
      "settings": {
        "runWhenPageLoads": true
      },
      "transformer": "return data.map(listing => ({...listing, currentBidDisplay: `${listing.currentBid || listing.startingPrice} —Å–æ–º–æ–Ω–∏`, sellerDisplay: listing.seller?.fullName || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ', carDisplay: `${listing.make} ${listing.model} ${listing.year}`, statusColor: {'pending': 'orange', 'active': 'green', 'ended': 'gray', 'rejected': 'red'}[listing.status] || 'gray'}));"
    },
    "getBids": {
      "id": "getBids",
      "type": "restapi",
      "data": {
        "url": "https://task-tracker-serviceapp225.replit.app/api/admin/bids",
        "method": "GET", 
        "headers": {
          "x-admin-key": "retool-admin-key-2024"
        }
      },
      "settings": {
        "runWhenPageLoads": true
      },
      "transformer": "return data.map(bid => ({...bid, amountDisplay: `${bid.amount} —Å–æ–º–æ–Ω–∏`, bidderDisplay: bid.bidder?.fullName || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ', carDisplay: `${bid.listing?.make} ${bid.listing?.model} ${bid.listing?.year}`, lotDisplay: bid.listing?.lotNumber, dateDisplay: new Date(bid.createdAt).toLocaleDateString('ru-RU'), timeDisplay: new Date(bid.createdAt).toLocaleTimeString('ru-RU'), bidderPhone: bid.bidder?.phoneNumber || '–ù–µ —É–∫–∞–∑–∞–Ω'}));"
    }
  },
  "components": {
    "statsTitle": {
      "id": "statsTitle",
      "type": "text",
      "data": {
        "value": "üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã AutoBid"
      },
      "position": {
        "x": 0,
        "y": 0,
        "w": 24,
        "h": 2
      }
    },
    "pendingCard": {
      "id": "pendingCard", 
      "type": "text",
      "data": {
        "value": "üïê –û–∂–∏–¥–∞—é—â–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è: {{getStats.data.pendingListings}}"
      },
      "position": {
        "x": 0,
        "y": 2,
        "w": 6,
        "h": 4
      }
    },
    "activeCard": {
      "id": "activeCard",
      "type": "text", 
      "data": {
        "value": "üî• –ê–∫—Ç–∏–≤–Ω—ã–µ –∞—É–∫—Ü–∏–æ–Ω—ã: {{getStats.data.activeAuctions}}"
      },
      "position": {
        "x": 6,
        "y": 2,
        "w": 6,
        "h": 4
      }
    },
    "usersCard": {
      "id": "usersCard",
      "type": "text",
      "data": {
        "value": "üë• –í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: {{getStats.data.totalUsers}}"
      },
      "position": {
        "x": 12,
        "y": 2,
        "w": 6,
        "h": 4
      }
    },
    "bannedCard": {
      "id": "bannedCard",
      "type": "text",
      "data": {
        "value": "üö´ –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ: {{getStats.data.bannedUsers}}"
      },
      "position": {
        "x": 18,
        "y": 2,
        "w": 6,
        "h": 4
      }
    },
    "usersTable": {
      "id": "usersTable",
      "type": "table",
      "data": {
        "dataSource": "{{getUsers.data}}",
        "columns": [
          {"key": "id", "title": "ID", "width": 60},
          {"key": "fullName", "title": "–ò–º—è", "width": 150},
          {"key": "phoneDisplay", "title": "–¢–µ–ª–µ—Ñ–æ–Ω", "width": 120},
          {"key": "email", "title": "Email", "width": 200},
          {"key": "statusDisplay", "title": "–°—Ç–∞—Ç—É—Å", "width": 100},
          {"key": "role", "title": "–†–æ–ª—å", "width": 80},
          {"key": "createdDisplay", "title": "–°–æ–∑–¥–∞–Ω", "width": 100}
        ]
      }
    },
    "listingsTable": {
      "id": "listingsTable",
      "type": "table",
      "data": {
        "dataSource": "{{getListings.data}}",
        "columns": [
          {"key": "id", "title": "ID", "width": 60},
          {"key": "lotNumber", "title": "–õ–æ—Ç", "width": 80},
          {"key": "carDisplay", "title": "–ê–≤—Ç–æ–º–æ–±–∏–ª—å", "width": 200},
          {"key": "currentBidDisplay", "title": "–¶–µ–Ω–∞", "width": 120},
          {"key": "status", "title": "–°—Ç–∞—Ç—É—Å", "width": 100},
          {"key": "sellerDisplay", "title": "–ü—Ä–æ–¥–∞–≤–µ—Ü", "width": 150},
          {"key": "bidCount", "title": "–°—Ç–∞–≤–æ–∫", "width": 70}
        ]
      }
    },
    "bidsTable": {
      "id": "bidsTable",
      "type": "table",
      "data": {
        "dataSource": "{{getBids.data}}",
        "columns": [
          {"key": "id", "title": "ID", "width": 60},
          {"key": "amountDisplay", "title": "–°—É–º–º–∞", "width": 120},
          {"key": "bidderDisplay", "title": "–ü–æ–∫—É–ø–∞—Ç–µ–ª—å", "width": 150},
          {"key": "bidderPhone", "title": "–¢–µ–ª–µ—Ñ–æ–Ω", "width": 120},
          {"key": "carDisplay", "title": "–ê–≤—Ç–æ–º–æ–±–∏–ª—å", "width": 200},
          {"key": "lotDisplay", "title": "–õ–æ—Ç", "width": 80},
          {"key": "dateDisplay", "title": "–î–∞—Ç–∞", "width": 100},
          {"key": "timeDisplay", "title": "–í—Ä–µ–º—è", "width": 80}
        ]
      }
    }
  }
}